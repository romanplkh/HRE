@model HorizonRE.Models.Employee

@{
    ViewBag.Title = "Add";
    Layout = "~/Views/Shared/_Admin.cshtml";
}

<div class="container mt-md-5 mt-sm-0">
    <i class="fas fa-arrow-left text-primary"></i> @Html.ActionLink("Back to Employees", "Index", "Employee")
    <h2 class="text-center display-4">Add Employee</h2>

    @using (Html.BeginForm("Add", "Employee", FormMethod.Post, new {id = "form"}))
    {
        @Html.AntiForgeryToken()

        @Html.Partial("_AddEditEmployee")


        <button type="submit" class="btn btn-primary float-right">Add</button>
        <button id="reset" type="button" class="btn btn-secondary float-right">Reset</button>
    }


</div>

<script>
    var resetBtn = document.querySelector('#reset');
    var form = document.querySelector('form')


    resetBtn.addEventListener('click',
        () => {
            var elms = form.querySelectorAll('input');

            var spans = form.querySelectorAll('span');

            Array.from(spans).forEach(el => {
                el.textContent = "";
            });

            Array.from(elms).forEach(el => {
                el.value = "";
                if (el.hasAttribute("aria-invalid")) {
                    el.setAttribute("aria-invalid", "false");
                }
            });


        });

    //DropDowns 
    var country = document.querySelector('#CountryList');


    country.addEventListener('change',
        () => {

            var selectedCountryId = country.value;

            fetch(`/employee/GetProvincesByCountry?countryId=${selectedCountryId}`).then(jsn => jsn.json()).then(
                data => {
                    var listProvinces = document.querySelector("#ProvincesList");

                    listProvinces.innerHTML = "";


                    data.forEach(el => {

                        var option = document.createElement("option");
                        option.value = el.ProvinceId;
                        option.innerHTML = el.Name;
                        listProvinces.appendChild(option);
                    });


                }
            );

        });


</script>